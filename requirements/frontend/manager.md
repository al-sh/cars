# UI Панели менеджера

> **Зависимости:** CONTEXT.md, contracts/api.md, contracts/types.md

Веб-интерфейс для роли "Менеджер": просмотр чатов клиентов и управление списком клиентов.

---

## Навигация

```
┌──────────────────────────────────────────────────────────┐
│  🚗 CarsAI Manager                        [Менеджер ▼]  │
├──────────────────────────────────────────────────────────┤
│  [Клиенты]  [Чаты]                                       │
├──────────────────────────────────────────────────────────┤
│                                                          │
│                    Content Area                          │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

**Табы:**
- Клиенты (`/manager/clients`) — список пользователей
- Чаты (`/manager/chats`) — все чаты клиентов

---

## Страница "Клиенты"

### Таблица клиентов

| Колонка | Сортировка | Описание |
|---------|------------|----------|
| Имя | ✓ | Имя пользователя |
| Email | ✓ | Email |
| Дата регистрации | ✓ | created_at |
| Чатов | — | Количество чатов |
| Действия | — | Кнопки действий |

### Фильтры и поиск

```
┌──────────────────────────────────────────────────────────┐
│ 🔍 Поиск по имени или email...                          │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  Имя ▼        Email           Регистрация ▼    Чатов    │
│ ─────────────────────────────────────────────────────── │
│  Иван        ivan@mail.ru     21.01.2026       3    [⋮] │
│  Мария       maria@gmail.com  20.01.2026       1    [⋮] │
│  Пётр        petr@yandex.ru   19.01.2026       5    [⋮] │
│                                                          │
├──────────────────────────────────────────────────────────┤
│  ◀ 1 2 3 ... 10 ▶                    Показано 1-20 из 42 │
└──────────────────────────────────────────────────────────┘
```

### Действия с клиентом

Меню (три точки):
- **Просмотр чатов** → переход на `/manager/clients/{id}/chats`
- **Редактировать** → модалка редактирования (имя)
- **Удалить** → модалка подтверждения (soft delete)

---

## Страница "Чаты"

Все чаты всех клиентов с возможностью фильтрации.

### Таблица чатов

| Колонка | Сортировка | Описание |
|---------|------------|----------|
| Клиент | ✓ | Имя пользователя |
| Название чата | — | title |
| Создан | ✓ | created_at |
| Обновлён | ✓ | updated_at |
| Сообщений | — | message_count |
| Действия | — | Кнопка просмотра |

### Фильтры

- Поиск по имени клиента
- Поиск по названию чата
- Дата создания (от-до)

### Просмотр чата

Клик на чат → переход на `/manager/chats/{id}` → режим read-only:

```
┌──────────────────────────────────────────────────────────┐
│  ← Назад          Чат: Подбор кроссовера                │
│                   Клиент: Иван (ivan@mail.ru)           │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  ┌──────────────────────────────────────┐                │
│  │ 🤖 Здравствуйте! Я помогу подобрать │                │
│  │    автомобиль...                     │                │
│  └──────────────────────────────────────┘                │
│                                                          │
│       ┌────────────────────────────────┐                 │
│       │ 👤 Ищу кроссовер до 3 млн     │                 │
│       └────────────────────────────────┘                 │
│                                                          │
│  ┌──────────────────────────────────────┐                │
│  │ 🤖 Отличный выбор! Уточните тип    │                │
│  │    двигателя...                      │                │
│  └──────────────────────────────────────┘                │
│                                                          │
│               (Режим просмотра — без поля ввода)         │
└──────────────────────────────────────────────────────────┘
```

---

## Страница "Чаты клиента"

URL: `/manager/clients/{id}/chats`

Чаты конкретного клиента.

```
┌──────────────────────────────────────────────────────────┐
│  ← К списку клиентов                                    │
│  Чаты клиента: Иван Петров (ivan@mail.ru)               │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  Название чата          Создан        Сообщений         │
│ ─────────────────────────────────────────────────────── │
│  Подбор кроссовера      21.01.2026    12           [→]  │
│  Семейный минивэн       20.01.2026    8            [→]  │
│  Авто для новичка       18.01.2026    5            [→]  │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

---

## Компоненты

### DataTable (переиспользуемый)

```typescript
interface Column<T> {
  key: keyof T;
  header: string;
  sortable?: boolean;
  render?: (value: T[keyof T], row: T) => string | TemplateRef;
}

interface TableConfig<T> {
  columns: Column<T>[];
  data: T[];
  loading: boolean;
  pagination: {
    page: number;
    perPage: number;
    total: number;
  };
  onSort: (key: string, direction: 'asc' | 'desc') => void;
  onPageChange: (page: number) => void;
}
```

### SearchInput

- Debounce 300ms
- Clear button
- Loading indicator при поиске

### ConfirmModal

- Title
- Message
- Cancel / Confirm buttons
- Danger variant для удаления

### Pagination

- First / Prev / Next / Last
- Page numbers (max 7 visible)
- "Показано X-Y из Z"
- Selector per_page (10, 20, 50)

---

## Роутинг

| URL | Компонент | Описание |
|-----|-----------|----------|
| `/manager` | Redirect | → /manager/clients |
| `/manager/clients` | ClientsPage | Список клиентов |
| `/manager/clients/:id/chats` | ClientChatsPage | Чаты клиента |
| `/manager/chats` | AllChatsPage | Все чаты |
| `/manager/chats/:id` | ChatViewPage | Просмотр чата (read-only) |

---

## Авторизация

- Доступ только для роли `manager`
- При попытке доступа с ролью `client` → редирект на `/chat`
- При 401 → редирект на `/login`

---

## Состояния

### Таблицы

| Состояние | Отображение |
|-----------|-------------|
| Loading | Skeleton rows (5 штук) |
| Empty | "Нет данных" + illustration |
| Empty search | "По запросу ничего не найдено" |
| Error | "Ошибка загрузки" + retry button |

### Модалки

- Backdrop click → close
- Escape → close
- Focus trap внутри
- Loading state на confirm button

---

## Адаптивность

### Desktop (>1024px)
- Полная таблица со всеми колонками

### Tablet (768-1024px)
- Скрыть колонку Email
- Компактные отступы

### Mobile (<768px)
- Карточки вместо таблицы
- Stacked layout
- Full-width search
